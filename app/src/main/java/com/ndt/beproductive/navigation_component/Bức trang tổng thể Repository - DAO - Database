? CÃ¢u há»i Ä‘ang tháº¯c máº¯c lÃ  khi triá»ƒn khai DI vá»›i ROOM thÃ¬ Repository, DAO, Database Ä‘Æ°á»£c inject tháº¿ nÃ o

1. Bá»©c tranh tá»•ng thá»ƒ: Repository â€“ DAO â€“ Database

    - Trong kiáº¿n trÃºc MVVM vá»›i Room:

    - UI (ViewModel) â†’ gá»i Ä‘áº¿n Repository.

    - Repository â†’ Ä‘Ã³ng vai trÃ² "cáº§u ná»‘i" giá»¯a UI vÃ  Data Source (Room DB, API, Cache...).

    - DAO (Data Access Object) â†’ cung cáº¥p method truy váº¥n (insert, delete, query...).

    - AppDatabase â†’ lá»›p abstract, Ä‘áº¡i diá»‡n cho Room Database, sinh ra implementation cá»§a cÃ¡c DAO.

    ------->  ViewModel -> Repository -> DAO -> Room Database -> SQLite

2. Táº¡i sao Repository cáº§n NoteDAO, khÃ´ng cáº§n AppDatabase?

    Repository chá»‰ quan tÃ¢m Ä‘áº¿n cÃ¡c thao tÃ¡c dá»¯ liá»‡u cá»¥ thá»ƒ (insert, query, delete).

    CÃ¡c thao tÃ¡c nÃ y Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a á»Ÿ DAO interface.

    AppDatabase báº£n cháº¥t chá»‰ lÃ  "factory" Ä‘á»ƒ táº¡o ra NoteDAO (vÃ  cÃ¡c DAO khÃ¡c).

    Náº¿u inject tháº³ng AppDatabase vÃ o Repository, thÃ¬ trong Repository láº¡i pháº£i gá»i db.noteDao().
        ----> CÃ³ nghÄ©a lÃ  láº¡i new Database() trong repository ---> Phá»¥ thuá»™c

    Äiá»u nÃ y:

        Coupling cao (Repository phá»¥ thuá»™c AppDatabase).

        KhÃ³ test (mock DAO thÃ¬ dá»… hÆ¡n mock Database).

        Best practice: Repository nÃªn nháº­n DAO â†’ rÃµ rÃ ng hÆ¡n, testable hÆ¡n.

3. Táº¡i sao trong AppModule láº¡i provide AppDatabase?

    Bá»Ÿi vÃ¬:

        Room sinh ra DAO thÃ´ng qua AppDatabase.

        Báº¡n khÃ´ng thá»ƒ trá»±c tiáº¿p táº¡o ra NoteDao, mÃ  pháº£i Ä‘i qua Room.databaseBuilder(...) Ä‘á»ƒ cÃ³ AppDatabase, rá»“i gá»i appDatabase.noteDao().

        Do Ä‘Ã³ trong AppModule (Hilt module):

        Provide AppDatabase trÆ°á»›c (singleton).

        Tá»« AppDatabase, provide NoteDao.

4. TÃ³m táº¯t luá»“ng DI

    Hilt biáº¿t cÃ¡ch táº¡o AppDatabase (nhá» provideDatabase).

    Tá»« AppDatabase, Hilt biáº¿t cÃ¡ch táº¡o NoteDao (nhá» provideNoteDao).

    Khi báº¡n inject NoteRepository, Hilt tá»± Ä‘á»™ng tÃ¬m dependency:

    NoteRepository cáº§n NoteDao.

    Hilt tháº¥y Ä‘Ã£ cÃ³ cÃ¡ch táº¡o NoteDao tá»« AppDatabase.

    Hilt tiÃªm vÃ o cho Repository.

    ğŸ‘‰ Káº¿t quáº£:

        Repository khÃ´ng phá»¥ thuá»™c AppDatabase.

        AppDatabase chá»‰ Ä‘Æ°á»£c quáº£n lÃ½ 1 nÆ¡i (AppModule, Singleton).